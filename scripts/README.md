# T-HOLDEM ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸

Firebase applications ì»¬ë ‰ì…˜ì˜ `postId` í•„ë“œë¥¼ `eventId`ë¡œ í†µì¼í•˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.

## ğŸ¯ ëª©ì 

T-HOLDEM í”„ë¡œì íŠ¸ì—ì„œ `postId`ì™€ `eventId` í•„ë“œê°€ í˜¼ì¬í•˜ì—¬ ì‚¬ìš©ë˜ê³  ìˆì–´ ë°ì´í„° ì¼ê´€ì„± ë¬¸ì œë¥¼ í•´ê²°í•©ë‹ˆë‹¤.

## ğŸ“‹ ì‚¬ì „ ìš”êµ¬ì‚¬í•­

1. **Firebase Admin SDK í‚¤**: `firebase-adminsdk-key.json` íŒŒì¼ì„ ìŠ¤í¬ë¦½íŠ¸ ë””ë ‰í† ë¦¬ì— ë°°ì¹˜
2. **Node.js**: ë²„ì „ 16 ì´ìƒ
3. **Firebase í”„ë¡œì íŠ¸ ì ‘ê·¼ ê¶Œí•œ**: `tholdem-ebc18` í”„ë¡œì íŠ¸

## ğŸš€ ì‚¬ìš©ë²•

### 1. ì˜ì¡´ì„± ì„¤ì¹˜
```bash
cd scripts
npm install
```

### 2. Firebase Admin SDK í‚¤ ì„¤ì •
```bash
# Firebase ì½˜ì†”ì—ì„œ ë‹¤ìš´ë¡œë“œí•œ ì„œë¹„ìŠ¤ ê³„ì • í‚¤ë¥¼ ë°°ì¹˜
cp path/to/your/firebase-adminsdk-key.json ./firebase-adminsdk-key.json
```

### 3. ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
npm run migrate

# ë˜ëŠ” ì§ì ‘ ì‹¤í–‰
node migratePostIdToEventId.js
```

### 4. ë¡¤ë°± (í•„ìš”ì‹œ)
```bash
# ë°±ì—… íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ë¡¤ë°±
npm run rollback <ë°±ì—…íŒŒì¼ê²½ë¡œ>

# ì˜ˆì‹œ
node migratePostIdToEventId.js --rollback applications_backup_2025-02-02T10-30-00-000Z.json
```

## ğŸ“Š ë§ˆì´ê·¸ë ˆì´ì…˜ ê³¼ì •

1. **í˜„ì¬ ìƒíƒœ ë¶„ì„**: applications ì»¬ë ‰ì…˜ì˜ í•„ë“œ í˜„í™© ë¶„ì„
2. **ë°±ì—… ìƒì„±**: ì „ì²´ ë°ì´í„°ì˜ JSON ë°±ì—… íŒŒì¼ ìƒì„±
3. **ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰**: 
   - `postId`ë§Œ ìˆëŠ” ë¬¸ì„œ â†’ `eventId` ì¶”ê°€ í›„ `postId` ì œê±°
   - ë‘ í•„ë“œ ëª¨ë‘ ìˆëŠ” ë¬¸ì„œ â†’ `postId` ì œê±° (eventId ìš°ì„ )
4. **ê²°ê³¼ ë¦¬í¬íŠ¸**: ì²˜ë¦¬ ê²°ê³¼ ë° í†µê³„ ì œê³µ

## ğŸ”’ ì•ˆì „ ê¸°ëŠ¥

- **ìë™ ë°±ì—…**: ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ ì „ì²´ ë°ì´í„° ë°±ì—…
- **ë°°ì¹˜ ì²˜ë¦¬**: Firestore ì œí•œì— ë§ëŠ” ì•ˆì „í•œ ë°°ì¹˜ ì²˜ë¦¬
- **ë¡¤ë°± ì§€ì›**: ë¬¸ì œ ë°œìƒ ì‹œ ì›ìƒ ë³µêµ¬ ê°€ëŠ¥
- **ìƒì„¸ ë¡œê¹…**: ì „ ê³¼ì • ë¡œê·¸ ë° ì˜¤ë¥˜ ì¶”ì 

## ğŸ“ ìƒì„± íŒŒì¼

### ë°±ì—… íŒŒì¼
```
applications_backup_YYYY-MM-DDTHH-mm-ss-sssZ.json
```

### ë¦¬í¬íŠ¸ íŒŒì¼
```json
{
  "timestamp": "2025-02-02T10:30:00.000Z",
  "stats": {
    "totalDocuments": 150,
    "migratedDocuments": 120,
    "skippedDocuments": 25,
    "errorDocuments": 5,
    "errors": [...]
  },
  "migration": "postId_to_eventId",
  "collection": "applications"
}
```

## âš ï¸ ì£¼ì˜ì‚¬í•­

1. **í”„ë¡œë•ì…˜ í™˜ê²½**: ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ë¨¼ì € ì‹¤í–‰
2. **ë°±ì—… í™•ì¸**: ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ ë°±ì—… íŒŒì¼ ìƒì„± í™•ì¸
3. **ë™ì‹œ ì‹¤í–‰ ê¸ˆì§€**: í•œ ë²ˆì— í•˜ë‚˜ì˜ ë§ˆì´ê·¸ë ˆì´ì…˜ë§Œ ì‹¤í–‰
4. **ì„œë¹„ìŠ¤ í‚¤ ë³´ì•ˆ**: Admin SDK í‚¤ íŒŒì¼ì„ ì•ˆì „í•˜ê²Œ ê´€ë¦¬

## ğŸ” ë¬¸ì œ í•´ê²°

### Firebase ì—°ê²° ì˜¤ë¥˜
```
Error: Could not load the default credentials
```
â†’ `firebase-adminsdk-key.json` íŒŒì¼ ê²½ë¡œ í™•ì¸

### ê¶Œí•œ ì˜¤ë¥˜
```
Error: Missing or insufficient permissions
```
â†’ ì„œë¹„ìŠ¤ ê³„ì •ì— Firestore ì½ê¸°/ì“°ê¸° ê¶Œí•œ í™•ì¸

### ë°°ì¹˜ í¬ê¸° ì´ˆê³¼
â†’ ìŠ¤í¬ë¦½íŠ¸ê°€ ìë™ìœ¼ë¡œ 500ê°œì”© ë°°ì¹˜ ì²˜ë¦¬

## ğŸ“ ì§€ì›

- í”„ë¡œì íŠ¸ ì´ìŠˆ: T-HOLDEM GitHub Issues
- ê¸´ê¸‰ ë¬¸ì˜: CLAUDE.md ì°¸ì¡°